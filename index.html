<!doctype html>
<html lang="vi">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>üéÅ Qu√† Sinh Nh·∫≠t</title>
  <style>
    :root{
      --glass: rgba(0,0,0,.35);
      --stroke: rgba(255,255,255,.25);
      --txt: #fff;
      --shadow: 0 18px 60px rgba(0,0,0,.35);
    }
    *{ box-sizing:border-box; }
    html,body{ height:100%; margin:0; font-family: system-ui,-apple-system,Segoe UI,Roboto,Arial; color:var(--txt); overflow:hidden; }

    /* N·ªÄN 2dau.png */
    body{
      background: url("./2dau.png") center/cover no-repeat fixed;
    }
    /* l·ªõp ph·ªß ƒë·ªÉ ch·ªØ n·ªïi h∆°n */
    .overlay{
      position:fixed; inset:0;
      background: radial-gradient(circle at 30% 10%, rgba(255,255,255,.10), transparent 40%),
                  linear-gradient(to bottom, rgba(0,0,0,.25), rgba(0,0,0,.55));
      pointer-events:none;
    }

    /* Canvas hi·ªáu ·ª©ng */
    canvas{ position:fixed; inset:0; width:100%; height:100%; pointer-events:none; }

    /* N√∫t gi·ªØa */
    .center{
      position:fixed; inset:0;
      display:grid; place-items:center;
      padding: 18px;
      z-index: 5;
    }
    .gift-btn{
      border:0;
      cursor:pointer;
      padding: 16px 22px;
      border-radius: 18px;
      font-weight: 800;
      font-size: 18px;
      color:#1c1c1c;
      background: linear-gradient(90deg, #ffffff, #ffe3ef);
      box-shadow: var(--shadow);
      transform: translateY(0);
      transition: transform .15s ease, filter .15s ease;
    }
    .gift-btn:hover{ transform: translateY(-2px); filter: brightness(1.03); }
    .gift-btn:active{ transform: translateY(0) scale(.98); }

    /* H·ªôp qu√† m·ªü ra */
    .modal{
      position:fixed; inset:0;
      display:none;
      place-items:center;
      z-index: 10;
      padding: 22px;
    }
    .modal.show{ display:grid; }

    .card{
      width:min(980px, 92vw);
      border-radius: 26px;
      background: rgba(0,0,0,.35);
      border:1px solid rgba(255,255,255,.22);
      box-shadow: var(--shadow);
      backdrop-filter: blur(10px);
      overflow:hidden;
      position:relative;
    }
    .card-head{
      padding: 14px 16px;
      display:flex;
      justify-content:space-between;
      align-items:center;
      gap:12px;
      border-bottom: 1px solid rgba(255,255,255,.18);
    }
    .card-head b{ font-size:14px; letter-spacing:.3px; }
    .close{
      background: rgba(255,255,255,.12);
      color:#fff;
      border:1px solid rgba(255,255,255,.22);
      border-radius: 12px;
      padding: 8px 12px;
      cursor:pointer;
      font-weight:700;
    }

    .photo-wrap{
      position:relative;
      background:#000;
      display:grid;
      place-items:center;
    }
    .photo-wrap img{
      width:100%;
      height:auto;
      display:block;
      max-height: 72vh;
      object-fit: contain;
      background: rgba(0,0,0,.25);
    }

    /* Ch·ªØ ch·∫°y tr√™n ·∫£nh */
    .caption{
      position:absolute;
      left: 50%;
      transform: translateX(-50%);
      bottom: 16px;
      width:min(92%, 820px);
      padding: 12px 14px;
      border-radius: 18px;
      background: rgba(0,0,0,.45);
      border:1px solid rgba(255,255,255,.22);
      overflow:hidden;
    }
    .line{
      font-weight:800;
      font-size: clamp(16px, 2.4vw, 22px);
      line-height: 1.5;
      white-space: nowrap;
      display:block;
      opacity: 0;
      transform: translateY(16px);
      transition: opacity .5s ease, transform .5s ease;
      text-shadow: 0 10px 30px rgba(0,0,0,.35);
    }
    .line.show{
      opacity: 1;
      transform: translateY(0);
    }

    /* Tr√°i tim bay */
    .heart{
      position:fixed;
      pointer-events:none;
      animation: floatUp linear forwards;
      filter: drop-shadow(0 10px 18px rgba(0,0,0,.25));
      will-change: transform, opacity;
      z-index: 2;
    }
    @keyframes floatUp{
      0%{ transform: translateY(0) translateX(0) scale(1); opacity:0; }
      10%{ opacity:1; }
      100%{ transform: translateY(-110vh) translateX(var(--drift)) scale(1.6); opacity:0; }
    }

    /* Nh·∫Øc b·∫•m ƒë·ªÉ b·∫≠t nh·∫°c */
    .hint{
      position:fixed;
      left:50%;
      transform:translateX(-50%);
      bottom: 14px;
      z-index: 6;
      font-size: 13px;
      padding: 10px 12px;
      border-radius: 999px;
      background: rgba(0,0,0,.35);
      border:1px solid rgba(255,255,255,.2);
      backdrop-filter: blur(8px);
    }
  </style>
</head>

<body>
  <div class="overlay"></div>
  <canvas id="fx"></canvas>

  <div class="center">
    <button class="gift-btn" id="openGift">üéÅ M·ªû QU√Ä</button>
  </div>

  <div class="hint" id="hint">N·∫øu kh√¥ng nghe nh·∫°c, anh b·∫•m ‚ÄúM·ªû QU√Ä‚Äù m·ªôt l·∫ßn ƒë·ªÉ cho ph√©p ph√°t nh·∫°c.</div>

  <!-- Modal hi·ªÉn th·ªã ·∫£nh anh1.png + ch·ªØ ch·∫°y -->
  <div class="modal" id="modal">
    <div class="card">
      <div class="card-head">
        <b>üéâ Happy Birthday</b>
        <button class="close" id="closeModal">ƒê√≥ng</button>
      </div>

      <div class="photo-wrap">
        <img src="./anh1.png" alt="·∫¢nh k·ª∑ ni·ªám">
        <div class="caption">
          <span class="line" id="line1"></span>
          <span class="line" id="line2"></span>
          <span class="line" id="line3"></span>
          <span class="line" id="line4"></span>
        </div>
      </div>
    </div>
  </div>

  <!-- Nh·∫°c local (anh t·ª± upload file mp3 v√†o repo) -->
  <audio id="music" loop preload="auto">
    <source src="./anh-nang-cua-anh.mp3" type="audio/mpeg">
  </audio>

  <script>
    /* =========================
       CONFIG: ch·ªânh l·ªùi ch√∫c ·ªü ƒë√¢y
       ========================= */
    const WISH_LINES = [
      "Ch√∫c em tu·ªïi m·ªõi lu√¥n r·ª±c r·ª° v√† b√¨nh an.",
      "Lu√¥n c∆∞·ªùi nhi·ªÅu, lu√¥n ƒë∆∞·ª£c y√™u th∆∞∆°ng th·∫≠t nhi·ªÅu.",
      "M·ªçi ƒëi·ªÅu em mong ƒë·ªÅu s·∫Ω th√†nh hi·ªán th·ª±c.",
      "Sinh nh·∫≠t vui v·∫ª nh√©, c√¥ g√°i c·ªßa anh. ‚ù§Ô∏è"
    ];

    /* =========================
       1) TR√ÅI TIM BAY LI√äN T·ª§C
       ========================= */
    const hearts = ["üíñ","üíó","üíò","üíù","üíû","üíï","‚ù§Ô∏è","üå∏","‚ú®"];
    function spawnHeart(){
      const h = document.createElement("div");
      h.className = "heart";
      h.textContent = hearts[Math.floor(Math.random()*hearts.length)];

      const left = Math.random() * window.innerWidth;
      const top  = window.innerHeight + 20;
      const drift = (Math.random()*180 - 90) + "px";
      const dur = (Math.random()*2.2 + 3.2).toFixed(2);

      h.style.left = left + "px";
      h.style.top  = top + "px";
      h.style.setProperty("--drift", drift);
      h.style.animationDuration = dur + "s";
      h.style.fontSize = (Math.random()*18 + 14).toFixed(0) + "px";

      document.body.appendChild(h);
      setTimeout(()=>h.remove(), (parseFloat(dur)+0.2)*1000);
    }
    setInterval(spawnHeart, 160); // tim bay li√™n t·ª•c

    /* =========================
       2) PH√ÅO HOA LI√äN T·ª§C (canvas)
       ========================= */
    const canvas = document.getElementById("fx");
    const ctx = canvas.getContext("2d");
    let W=0,H=0,dpr=1;

    function resize(){
      dpr = Math.max(1, Math.min(2, window.devicePixelRatio || 1));
      W = canvas.width  = Math.floor(window.innerWidth * dpr);
      H = canvas.height = Math.floor(window.innerHeight * dpr);
      canvas.style.width  = window.innerWidth + "px";
      canvas.style.height = window.innerHeight + "px";
    }
    window.addEventListener("resize", resize);
    resize();

    const particles = [];
    function firework(x, y){
      const cx = x*dpr, cy = y*dpr;
      const n = 70;
      for(let i=0;i<n;i++){
        const a = (Math.PI*2)*(i/n);
        const sp = (Math.random()*3.8+2.0)*dpr;
        particles.push({
          x: cx, y: cy,
          vx: Math.cos(a)*sp*(Math.random()*0.7+0.7),
          vy: Math.sin(a)*sp*(Math.random()*0.7+0.7),
          g: 0.03*dpr,
          life: 0, ttl: Math.random()*70+55,
          hue: (Math.random()*360)|0,
          r: (Math.random()*2.2+1.2)*dpr
        });
      }
    }

    // ph√°o hoa t·ª± ƒë·ªông li√™n t·ª•c
    setInterval(()=>{
      firework(
        window.innerWidth*(Math.random()*0.7+0.15),
        window.innerHeight*(Math.random()*0.35+0.25)
      );
    }, 420);

    function loop(){
      ctx.clearRect(0,0,W,H);

      for(let i=particles.length-1;i>=0;i--){
        const p = particles[i];
        p.life++;
        p.x += p.vx;
        p.y += p.vy;
        p.vy += p.g;
        p.vx *= 0.985;
        p.vy *= 0.985;

        ctx.save();
        ctx.globalCompositeOperation = "lighter";
        ctx.globalAlpha = Math.max(0, 1 - (p.life/p.ttl));
        ctx.fillStyle = `hsla(${p.hue}, 100%, 70%, 1)`;
        ctx.beginPath();
        ctx.arc(p.x, p.y, p.r, 0, Math.PI*2);
        ctx.fill();
        ctx.restore();

        if (p.life > p.ttl) particles.splice(i,1);
      }

      requestAnimationFrame(loop);
    }
    loop();

    /* =========================
       3) N√öT M·ªû QU√Ä -> HI·ªÜN ·∫¢NH + CH·ªÆ CH·∫†Y + PH√ÅT NH·∫†C
       ========================= */
    const openGift = document.getElementById("openGift");
    const modal = document.getElementById("modal");
    const closeModal = document.getElementById("closeModal");
    const music = document.getElementById("music");
    const hint = document.getElementById("hint");

    function showLines(){
      const els = [
        document.getElementById("line1"),
        document.getElementById("line2"),
        document.getElementById("line3"),
        document.getElementById("line4"),
      ];
      els.forEach((el,i)=>{
        el.textContent = WISH_LINES[i] || "";
        el.classList.remove("show");
      });

      // ch·∫°y l·∫ßn l∆∞·ª£t
      els.forEach((el,i)=>{
        setTimeout(()=> el.classList.add("show"), 350 + i*750);
      });
    }

    async function playMusic(){
      try{
        await music.play();
        hint.style.display = "none";
      }catch(e){
        // n·∫øu b·ªã ch·∫∑n autoplay
        hint.style.display = "block";
      }
    }

    openGift.addEventListener("click", async ()=>{
      // m·ªü qu√†
      modal.classList.add("show");
      showLines();

      // nh·∫°c: ch·ªâ ƒë·∫£m b·∫£o ph√°t sau thao t√°c click (ƒë√∫ng chu·∫©n browser)
      await playMusic();
    });

    closeModal.addEventListener("click", ()=>{
      modal.classList.remove("show");
    });

    // b·∫•m n·ªÅn ngo√†i card ƒë·ªÉ ƒë√≥ng
    modal.addEventListener("click", (e)=>{
      if (e.target === modal) modal.classList.remove("show");
    });
  </script>
</body>
</html>
